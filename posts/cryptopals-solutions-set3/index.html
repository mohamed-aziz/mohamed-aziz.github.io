<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Mohamed Aziz Knani (محمد عزيز الكناني) website/posts/cryptopals-solutions-set3/</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">
    <meta name="googlebot" content="index,follow,snippet,archive">
    <link rel="stylesheet" href="https://aziz.tn/hugo-theme-console/css/terminal-0.7.1.min.css">
    <link rel="stylesheet" href="https://aziz.tn/hugo-theme-console/css/animate-3.7.2.min.css">
    <link rel="stylesheet" href="https://aziz.tn/hugo-theme-console/css/console.css">
    
      <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
      <![endif]-->
       <meta property="og:title" content="Cryptopals - set3" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://aziz.tn/posts/cryptopals-solutions-set3/" /><meta property="article:published_time" content="2019-06-17T00:00:00+01:00" />



<meta name="twitter:title" content="Cryptopals - set3"/>
<meta name="twitter:description" content="Challenge 17 Attacking CBC with a padding attack was fascinating, here is my solution
from set2 import aes_cbc_decrypt, aes_cbc_encrypt, paddpkcs7, validatepkcs7, split_blocks from Crypto import Random from Crypto.Util.strxor import strxor def get_block(text, block, blocksize): return split_blocks(text, blocksize)[block] def produce_ciphertext(plaintext, key): blocksize = len(key) iv = Random.new().read(blocksize) return iv &#43; aes_cbc_encrypt(paddpkcs7(plaintext, blocksize), key, iv) def cbc_padding_oracle(ciphertext, key): blocksize = len(key) iv = ciphertext[:blocksize] return validatepkcs7(aes_cbc_decrypt(ciphertext[blocksize:], key, iv)) def break_cbc_padding_oracle(oracle, ciphertext, blocksize=16): plaintext_block = &#34;&#34; plaintext = &#34;&#34; prefix = &#34;&#34; for block_counter in range(1, len(split_blocks(ciphertext, blocksize))): current_block = get_block(ciphertext, block_counter, blocksize) last_block = get_block(ciphertext, block_counter-1, blocksize) for j in range(blocksize-1, -1, -1): for i in range(255)[::-1]: guessed_block = strxor(last_block, (&#34;\x00&#34; * j) &#43; chr(i) &#43; strxor(plaintext_block, (chr((blocksize - j)))*len(plaintext_block))) if oracle(prefix &#43; guessed_block &#43; current_block): plaintext_block = chr(i ^ (blocksize - j)) &#43; plaintext_block break plaintext &#43;= plaintext_block plaintext_block = &#34;&#34; prefix &#43;= last_block return plaintext Challenge 18 In this challenge, you implement CTR mode which turns a block cipher into a stream cipher."/>


<link rel="stylesheet" href="https://aziz.tn/css/syntax.css" />

</head>
<body class="terminal">
    <div class="container">
        <div class="terminal-nav">
          <header class="terminal-logo">
            <div class="logo terminal-prompt">
              
              
              <a href="https://aziz.tn/" class="no-style ">Mohamed Aziz Knani (محمد عزيز الكناني) website</a>:~# 
              <a href='https://aziz.tn/posts'>posts</a>/<a href='https://aziz.tn/posts/cryptopals-solutions-set3'>cryptopals-solutions-set3</a>/</div></header>
          <nav class="terminal-menu">
            <ul vocab="https://schema.org/" typeof="BreadcrumbList">
                
                <li><a href="https://aziz.tn/about/" typeof="ListItem">about/</a></li>
                
                <li><a href="https://aziz.tn/posts/" typeof="ListItem">posts/</a></li>
                
            </ul>
          </nav>
        </div>
    </div>

    <div class="container animated fadeInDown fast" >
        
<h1>Cryptopals - set3</h1>

Jun. 17, 2019


<br/><br/>
<h2 id="challenge-17">Challenge 17</h2>
<p>Attacking CBC with a padding attack was fascinating, here is my solution</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">set2</span> <span class="kn">import</span> <span class="n">aes_cbc_decrypt</span><span class="p">,</span> <span class="n">aes_cbc_encrypt</span><span class="p">,</span> <span class="n">paddpkcs7</span><span class="p">,</span> <span class="n">validatepkcs7</span><span class="p">,</span> <span class="n">split_blocks</span>
<span class="kn">from</span> <span class="nn">Crypto</span> <span class="kn">import</span> <span class="n">Random</span>
<span class="kn">from</span> <span class="nn">Crypto.Util.strxor</span> <span class="kn">import</span> <span class="n">strxor</span>


<span class="k">def</span> <span class="nf">get_block</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">blocksize</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">split_blocks</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">blocksize</span><span class="p">)[</span><span class="n">block</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">produce_ciphertext</span><span class="p">(</span><span class="n">plaintext</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="n">blocksize</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">iv</span> <span class="o">=</span> <span class="n">Random</span><span class="o">.</span><span class="n">new</span><span class="p">()</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">blocksize</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">iv</span> <span class="o">+</span> <span class="n">aes_cbc_encrypt</span><span class="p">(</span><span class="n">paddpkcs7</span><span class="p">(</span><span class="n">plaintext</span><span class="p">,</span> <span class="n">blocksize</span><span class="p">),</span> <span class="n">key</span><span class="p">,</span> <span class="n">iv</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">cbc_padding_oracle</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="n">blocksize</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">iv</span> <span class="o">=</span> <span class="n">ciphertext</span><span class="p">[:</span><span class="n">blocksize</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">validatepkcs7</span><span class="p">(</span><span class="n">aes_cbc_decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">[</span><span class="n">blocksize</span><span class="p">:],</span> <span class="n">key</span><span class="p">,</span> <span class="n">iv</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">break_cbc_padding_oracle</span><span class="p">(</span><span class="n">oracle</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">,</span> <span class="n">blocksize</span><span class="o">=</span><span class="mi">16</span><span class="p">):</span>
    <span class="n">plaintext_block</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
    <span class="n">plaintext</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
    <span class="k">for</span> <span class="n">block_counter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">split_blocks</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">blocksize</span><span class="p">))):</span>
      <span class="n">current_block</span> <span class="o">=</span> <span class="n">get_block</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">block_counter</span><span class="p">,</span> <span class="n">blocksize</span><span class="p">)</span>
      <span class="n">last_block</span> <span class="o">=</span> <span class="n">get_block</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">block_counter</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">blocksize</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">blocksize</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
	  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">255</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
	      <span class="n">guessed_block</span> <span class="o">=</span> <span class="n">strxor</span><span class="p">(</span><span class="n">last_block</span><span class="p">,</span>
				     <span class="p">(</span><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span> <span class="o">*</span> <span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">strxor</span><span class="p">(</span><span class="n">plaintext_block</span><span class="p">,</span> <span class="p">(</span><span class="nb">chr</span><span class="p">((</span><span class="n">blocksize</span> <span class="o">-</span> <span class="n">j</span><span class="p">)))</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">plaintext_block</span><span class="p">)))</span>
	      <span class="k">if</span> <span class="n">oracle</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="n">guessed_block</span> <span class="o">+</span> <span class="n">current_block</span><span class="p">):</span>
		  <span class="n">plaintext_block</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">i</span> <span class="o">^</span> <span class="p">(</span><span class="n">blocksize</span> <span class="o">-</span> <span class="n">j</span><span class="p">))</span> <span class="o">+</span> <span class="n">plaintext_block</span>
		  <span class="k">break</span>
      <span class="n">plaintext</span> <span class="o">+=</span> <span class="n">plaintext_block</span>
      <span class="n">plaintext_block</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
      <span class="n">prefix</span> <span class="o">+=</span> <span class="n">last_block</span>
    <span class="k">return</span> <span class="n">plaintext</span>
</code></pre></div><h2 id="challenge-18">Challenge 18</h2>
<p>In this challenge, you implement CTR mode which turns a block cipher into a stream cipher.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">set2</span> <span class="kn">import</span> <span class="n">aes_ecb_encrypt</span>
<span class="kn">import</span> <span class="nn">struct</span>
<span class="kn">from</span> <span class="nn">Crypto.Util.strxor</span> <span class="kn">import</span> <span class="n">strxor</span>
<span class="kn">from</span> <span class="nn">set2</span> <span class="kn">import</span> <span class="n">split_blocks</span>


<span class="k">def</span> <span class="nf">form_nonce</span><span class="p">(</span><span class="n">nonce</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&#34;&lt;Q&#34;</span><span class="p">,</span> <span class="n">nonce</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">aes_ctr_produce_blocks</span><span class="p">(</span><span class="n">nonce</span><span class="p">):</span>
    <span class="c1"># xrange doesn&#39;t support 64 bit numbers</span>
    <span class="k">for</span> <span class="n">counter</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
      <span class="k">yield</span> <span class="n">nonce</span> <span class="o">+</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&#34;&lt;Q&#34;</span><span class="p">,</span> <span class="n">counter</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">aes_ctr_encrypt_block</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">aes_ecb_encrypt</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">aes_ctr_encrypt_decrypt</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">nonce</span><span class="p">):</span>
    <span class="n">blocksize</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">ctr_block_gen</span> <span class="o">=</span> <span class="n">aes_ctr_produce_blocks</span><span class="p">(</span><span class="n">nonce</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
    <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">split_blocks</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">blocksize</span><span class="p">):</span>
      <span class="n">blk</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">ctr_block_gen</span><span class="p">)</span>
      <span class="n">blk</span> <span class="o">=</span> <span class="n">aes_ctr_encrypt_block</span><span class="p">(</span><span class="n">blk</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
      <span class="n">blk</span> <span class="o">=</span> <span class="n">blk</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">block</span><span class="p">)]</span>
      <span class="n">output</span> <span class="o">+=</span> <span class="n">strxor</span><span class="p">(</span><span class="n">blk</span><span class="p">,</span> <span class="n">block</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">output</span>
</code></pre></div><h2 id="challenge-19">Challenge 19</h2>
<p>This is still unimplemented</p>
<h2 id="challenge-20">Challenge 20</h2>
<p>This is still unimplemented</p>
<h2 id="challenge-21">Challenge 21</h2>
<p>In this challenge, I implemented the mersenne twister</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">MT19937</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="n">W</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">624</span><span class="p">,</span> <span class="mi">397</span><span class="p">,</span> <span class="mi">31</span>
    <span class="n">A</span> <span class="o">=</span> <span class="mh">0x9908B0DF</span>
    <span class="n">U</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="mh">0xFFFFFFFF</span>
    <span class="n">S</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="mh">0x9D2C5680</span>
    <span class="n">T</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> <span class="mh">0xEFC60000</span>
    <span class="n">L</span> <span class="o">=</span> <span class="mi">18</span>
    <span class="n">F</span> <span class="o">=</span> <span class="mi">1812433253</span>
    <span class="n">LOWER_MASK</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">R</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">UPPER_MASK</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="n">LOWER_MASK</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">mt</span> <span class="o">=</span> <span class="p">[]</span>

      <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
	  <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">F</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">W</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)))</span> <span class="o">+</span> <span class="n">i</span><span class="o">&amp;</span> <span class="mh">0xffffffff</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span>

    <span class="k">def</span> <span class="nf">extract_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">:</span>
	  <span class="bp">self</span><span class="o">.</span><span class="n">twist</span><span class="p">()</span>

      <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
      <span class="n">y</span> <span class="o">^=</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">)</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span>
      <span class="n">y</span> <span class="o">^=</span> <span class="p">(</span><span class="n">y</span> <span class="o">&lt;&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">)</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">B</span>
      <span class="n">y</span> <span class="o">^=</span> <span class="p">(</span><span class="n">y</span> <span class="o">&lt;&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span>
      <span class="n">y</span> <span class="o">^=</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>

      <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
      <span class="k">return</span> <span class="n">y</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>

    <span class="k">def</span> <span class="nf">twist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
	  <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">UPPER_MASK</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">]</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">LOWER_MASK</span><span class="p">)</span>
	  <span class="n">xA</span> <span class="o">=</span> <span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
	  <span class="k">if</span> <span class="n">x</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
	      <span class="n">xA</span> <span class="o">^=</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span>

	  <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">]</span> <span class="o">^</span> <span class="n">xA</span>

      <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div><h2 id="challenge-22">Challenge 22</h2>
<p>This challenge teaches why you shouldn&rsquo;t see your MT19937 with curent time</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">set3</span> <span class="kn">import</span> <span class="n">MT19937</span>


<span class="k">def</span> <span class="nf">break_mt19937_seeded_time</span><span class="p">(</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">lim</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">timestamp</span><span class="o">-</span><span class="n">lim</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">):</span>
      <span class="n">obj</span> <span class="o">=</span> <span class="n">MT19937</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
      <span class="n">num2</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">extract_number</span><span class="p">()</span>
      <span class="k">if</span> <span class="n">num2</span> <span class="o">==</span> <span class="n">num</span><span class="p">:</span>
	  <span class="k">return</span> <span class="n">i</span>
    <span class="k">return</span> <span class="bp">None</span>
</code></pre></div><h2 id="challenge-23">Challenge 23</h2>
<p>Given enough consecutive outputs, you can clone the mersenne twister, 624 in the case of MT19937:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">set3</span> <span class="kn">import</span> <span class="n">MT19937</span>


<span class="k">def</span> <span class="nf">clone_mt19937</span><span class="p">(</span><span class="n">numbers</span><span class="p">):</span>
    <span class="n">T</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> <span class="mh">0xEFC60000</span>
    <span class="n">L</span> <span class="o">=</span> <span class="mi">18</span>
    <span class="n">U</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="mh">0xFFFFFFFF</span>
    <span class="n">S</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="mh">0x9D2C5680</span>
    <span class="n">mt</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">:</span>
      <span class="n">y</span> <span class="o">=</span> <span class="n">number</span>
      <span class="n">y</span> <span class="o">^=</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;&gt;</span> <span class="n">L</span><span class="p">)</span>
      <span class="n">y</span> <span class="o">^=</span> <span class="p">(</span><span class="n">y</span> <span class="o">&lt;&lt;</span> <span class="n">T</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">C</span>
      <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">S</span><span class="p">):</span>
	  <span class="n">y</span> <span class="o">^=</span> <span class="p">(</span><span class="n">y</span> <span class="o">&lt;&lt;</span> <span class="n">S</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">B</span>
      <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">U</span><span class="p">):</span>
	  <span class="n">y</span> <span class="o">^=</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;&gt;</span> <span class="n">U</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">D</span>
      <span class="n">mt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span><span class="p">)</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">MT19937</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">mt</span> <span class="o">=</span> <span class="n">mt</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">N</span>
    <span class="k">return</span> <span class="n">obj</span>
</code></pre></div><p>If you think about how to protect this, the weak link is the temper function which can be easily &ldquo;untempered&rdquo;, so you can implement one way functions like hashing functions, which will render untempering, computationally unfeasible.</p>
<h2 id="challenge-24">Challenge 24</h2>
<p>Recovering a 16 bit seed used for encryption:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">set3</span> <span class="kn">import</span> <span class="n">MT19937</span>
<span class="kn">from</span> <span class="nn">Crypto.Util.strxor</span> <span class="kn">import</span> <span class="n">strxor</span>
<span class="kn">from</span> <span class="nn">Crypto.Random</span> <span class="kn">import</span> <span class="n">random</span>
<span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span>


<span class="k">class</span> <span class="nc">MT19937Cipher</span><span class="p">(</span><span class="n">MT19937</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">):</span>
      <span class="nb">super</span><span class="p">(</span><span class="n">MT19937Cipher</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">seed</span> <span class="o">&amp;</span> <span class="mh">0xffff</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">gen_8_bit_val</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_number</span><span class="p">()</span> <span class="o">&amp;</span> <span class="mh">0xff</span>


<span class="k">def</span> <span class="nf">mt19937_cipher_oracle</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">MT19937Cipher</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">randlen</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
    <span class="n">ciphertext</span> <span class="o">+=</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">getrandbits</span><span class="p">(</span><span class="n">randlen</span> <span class="o">*</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)):</span>
      <span class="n">s</span> <span class="o">+=</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">gen_8_bit_val</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">strxor</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">break_mt19937_cipher</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mh">0xffff</span><span class="p">):</span>
      <span class="n">obj</span> <span class="o">=</span> <span class="n">MT19937Cipher</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
      <span class="n">s</span> <span class="o">=</span><span class="s2">&#34;&#34;</span>
      <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)):</span>
	  <span class="n">s</span> <span class="o">+=</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">gen_8_bit_val</span><span class="p">())</span>
      <span class="k">if</span> <span class="n">plaintext</span> <span class="ow">in</span> <span class="n">strxor</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">):</span>
	  <span class="k">return</span> <span class="n">i</span>
</code></pre></div><h2 id="tests">Tests</h2>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="ch">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64decode</span>
<span class="kn">from</span> <span class="nn">test</span> <span class="kn">import</span> <span class="n">support</span>
<span class="kn">from</span> <span class="nn">set3</span> <span class="kn">import</span> <span class="n">produce_ciphertext</span><span class="p">,</span> <span class="n">break_cbc_padding_oracle</span><span class="p">,</span> <span class="n">cbc_padding_oracle</span><span class="p">,</span> <span class="n">form_nonce</span><span class="p">,</span> <span class="n">aes_ctr_encrypt_decrypt</span><span class="p">,</span>\
    <span class="n">break_ctr_reused_nonce_substitutions</span><span class="p">,</span> <span class="n">MT19937</span><span class="p">,</span> <span class="n">break_mt19937_seeded_time</span><span class="p">,</span> <span class="n">clone_mt19937</span><span class="p">,</span>\
    <span class="n">mt19937_cipher_oracle</span><span class="p">,</span> <span class="n">break_mt19937_cipher</span>

<span class="kn">from</span> <span class="nn">set2</span> <span class="kn">import</span> <span class="n">encryption_get_oracle_func</span><span class="p">,</span> <span class="n">generate_random_key</span>
<span class="kn">from</span> <span class="nn">set1</span> <span class="kn">import</span> <span class="n">unpadpkcs7</span>
<span class="kn">from</span> <span class="nn">Crypto.Random</span> <span class="kn">import</span> <span class="n">random</span>


<span class="k">class</span> <span class="nc">Set3</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_ch17</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="n">key</span> <span class="o">=</span> <span class="n">generate_random_key</span><span class="p">()</span>
      <span class="n">oracle</span> <span class="o">=</span> <span class="n">encryption_get_oracle_func</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">cbc_padding_oracle</span><span class="p">)</span>

      <span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;MDAwMDAwTm93IHRoYXQgdGhlIHBhcnR5IGlzIGp1bXBpbmc=&#34;</span><span class="p">,</span>
	     <span class="s2">&#34;MDAwMDAxV2l0aCB0aGUgYmFzcyBraWNrZWQgaW4gYW5kIHRoZSBWZWdhJ3MgYXJlIHB1bXBpbic=&#34;</span><span class="p">,</span>
	     <span class="s2">&#34;MDAwMDAyUXVpY2sgdG8gdGhlIHBvaW50LCB0byB0aGUgcG9pbnQsIG5vIGZha2luZw==&#34;</span><span class="p">,</span>
	     <span class="s2">&#34;MDAwMDAzQ29va2luZyBNQydzIGxpa2UgYSBwb3VuZCBvZiBiYWNvbg==&#34;</span><span class="p">,</span>
	     <span class="s2">&#34;MDAwMDA0QnVybmluZyAnZW0sIGlmIHlvdSBhaW4ndCBxdWljayBhbmQgbmltYmxl&#34;</span><span class="p">,</span>
	     <span class="s2">&#34;MDAwMDA1SSBnbyBjcmF6eSB3aGVuIEkgaGVhciBhIGN5bWJhbA==&#34;</span><span class="p">,</span>
	     <span class="s2">&#34;MDAwMDA2QW5kIGEgaGlnaCBoYXQgd2l0aCBhIHNvdXBlZCB1cCB0ZW1wbw==&#34;</span><span class="p">,</span>
	     <span class="s2">&#34;MDAwMDA3SSdtIG9uIGEgcm9sbCwgaXQncyB0aW1lIHRvIGdvIHNvbG8=&#34;</span><span class="p">,</span>
	     <span class="s2">&#34;MDAwMDA4b2xsaW4nIGluIG15IGZpdmUgcG9pbnQgb2g=&#34;</span><span class="p">,</span>
	     <span class="s2">&#34;MDAwMDA5aXRoIG15IHJhZy10b3AgZG93biBzbyBteSBoYWlyIGNhbiBibG93&#34;</span><span class="p">]</span>

      <span class="k">for</span> <span class="n">plaintext</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">:</span>
	  <span class="c1">#test funcs</span>
	  <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">produce_ciphertext</span><span class="p">(</span><span class="n">plaintext</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
	  <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">oracle</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">))</span>

	  <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">unpadpkcs7</span><span class="p">(</span><span class="n">break_cbc_padding_oracle</span><span class="p">(</span><span class="n">oracle</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">)),</span> <span class="n">plaintext</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_ch18</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="n">cipher</span> <span class="o">=</span> <span class="n">b64decode</span><span class="p">(</span><span class="s2">&#34;L77na/nrFsKvynd6HzOoG7GHTLXsTVu9qvY/2syLXzhPweyyMTJULu/6/kXX0KSvoOLSFQ==&#34;</span><span class="p">)</span>
      <span class="n">key</span> <span class="o">=</span> <span class="s2">&#34;YELLOW SUBMARINE&#34;</span>
      <span class="n">nonce</span> <span class="o">=</span> <span class="n">form_nonce</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

      <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">aes_ctr_encrypt_decrypt</span><span class="p">(</span><span class="n">cipher</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">nonce</span><span class="p">),</span>
		       <span class="s2">&#34;Yo, VIP Let&#39;s kick it Ice, Ice, baby Ice, Ice, baby &#34;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_ch19</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="c1"># this is a many time pad problem</span>
      <span class="n">plaintexts</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="n">ciphertexts</span> <span class="o">=</span> <span class="p">[]</span>

      <span class="n">key</span> <span class="o">=</span> <span class="n">generate_random_key</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>

      <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;static/19.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">myfile</span><span class="p">:</span>
	  <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">myfile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
	      <span class="n">plaintexts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b64decode</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>

      <span class="k">for</span> <span class="n">plaintext</span> <span class="ow">in</span> <span class="n">plaintexts</span><span class="p">:</span>
	  <span class="n">nonce</span> <span class="o">=</span> <span class="n">form_nonce</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
	  <span class="n">ciphertexts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aes_ctr_encrypt_decrypt</span><span class="p">(</span><span class="n">plaintext</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">nonce</span><span class="p">))</span>

      <span class="n">break_ctr_reused_nonce_substitutions</span><span class="p">(</span><span class="n">ciphertexts</span><span class="p">)</span>
      <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">test_ch20</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="n">plaintexts</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="n">ciphertexts</span> <span class="o">=</span> <span class="p">[]</span>

      <span class="n">key</span> <span class="o">=</span> <span class="n">generate_random_key</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>

      <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;static/19.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">myfile</span><span class="p">:</span>
	  <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">myfile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
	      <span class="n">plaintexts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b64decode</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>

      <span class="k">for</span> <span class="n">plaintext</span> <span class="ow">in</span> <span class="n">plaintexts</span><span class="p">:</span>
	  <span class="n">nonce</span> <span class="o">=</span> <span class="n">form_nonce</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
	  <span class="n">ciphertexts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aes_ctr_encrypt_decrypt</span><span class="p">(</span><span class="n">plaintext</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">nonce</span><span class="p">))</span>

      <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">test_ch21</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="n">obj</span> <span class="o">=</span> <span class="n">MT19937</span><span class="p">(</span><span class="mi">1337</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">extract_number</span><span class="p">(),</span> <span class="mi">1125387415</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_ch22</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="kn">import</span> <span class="nn">time</span>
      <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)))</span>

      <span class="n">time_now</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
      <span class="n">orig_seed</span> <span class="o">=</span> <span class="n">time_now</span>
      <span class="n">obj</span> <span class="o">=</span> <span class="n">MT19937</span><span class="p">(</span><span class="n">time_now</span><span class="p">)</span>
      <span class="n">num</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">extract_number</span><span class="p">()</span>

      <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)))</span>

      <span class="n">i</span> <span class="o">=</span> <span class="n">break_mt19937_seeded_time</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()),</span> <span class="n">num</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">orig_seed</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_ch23</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

      <span class="k">for</span> <span class="n">randseed</span> <span class="ow">in</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100000</span><span class="p">))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]:</span>
	  <span class="n">obj</span> <span class="o">=</span> <span class="n">MT19937</span><span class="p">(</span><span class="n">randseed</span><span class="p">)</span>
	  <span class="n">numbers</span> <span class="o">=</span> <span class="p">[]</span>
	  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">624</span><span class="p">):</span>
	      <span class="n">f</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">extract_number</span><span class="p">()</span>
	      <span class="n">numbers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
	  <span class="n">obj2</span> <span class="o">=</span> <span class="n">clone_mt19937</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
	  <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">extract_number</span><span class="p">(),</span> <span class="n">obj2</span><span class="o">.</span><span class="n">extract_number</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">test_ch24</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="n">randseed</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mh">0xffff</span><span class="p">))</span>
      <span class="n">plaintext</span> <span class="o">=</span> <span class="s2">&#34;A&#34;</span> <span class="o">*</span> <span class="mi">14</span>
      <span class="n">cipher</span> <span class="o">=</span> <span class="n">mt19937_cipher_oracle</span><span class="p">(</span><span class="n">plaintext</span><span class="p">,</span> <span class="n">randseed</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">randseed</span><span class="p">,</span> <span class="n">break_mt19937_cipher</span><span class="p">(</span><span class="n">cipher</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">))</span>



<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
    <span class="n">support</span><span class="o">.</span><span class="n">run_unittest</span><span class="p">(</span><span class="n">Set3</span><span class="p">)</span>
</code></pre></div>


        <div class="footer">
    Powered by <a href="https://gohugo.io/">Hugo</a> with
    <a href="https://github.com/mrmierzejewski/hugo-theme-console/">Console Theme</a>. 
</div>

    </div>
  </body>
</html>
