<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Mohamed Aziz Knani (محمد عزيز الكناني) website/posts/how-i-print-books/</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">
    <meta name="googlebot" content="index,follow,snippet,archive">
    <link rel="stylesheet" href="https://aziz.tn/hugo-theme-console/css/terminal-0.7.1.min.css">
    <link rel="stylesheet" href="https://aziz.tn/hugo-theme-console/css/animate-3.7.2.min.css">
    <link rel="stylesheet" href="https://aziz.tn/hugo-theme-console/css/console.css">
    
      <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
      <![endif]-->
       <meta property="og:title" content="How I print books" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://aziz.tn/posts/how-i-print-books/" /><meta property="article:published_time" content="2018-11-08T00:00:00+01:00" />



<meta name="twitter:title" content="How I print books"/>
<meta name="twitter:description" content="I tend to print books and zines on paper rather than read it from the screen (I help to kill one small tree every week), I have some tools to do make this easier.
This is a shell script that splits a pdf into chapters using the builtin bookmarks:
#!/bin/bash  infile=$1 # input pdf outputprefix=$2 [ -e &#34;$infile&#34; -a -n &#34;$outputprefix&#34; ] || exit 1 # Invalid args pagenumbers=( $(pdftk &#34;$infile&#34; dump_data | grep -A1 &#39;^BookmarkLevel: 1&#39;| \ 	grep &#39;^BookmarkPageNumber: &#39; | cut -f2 -d&#39; &#39; | uniq) end ) for ((i=0; i &lt; ${#pagenumbers[@]} - 1; &#43;&#43;i)); do a=${pagenumbers[i]} # start page number b=${pagenumbers[i&#43;1]} # end page number [ &#34;$b&#34; = &#34;end&#34; ] || b=$[b-1] pdftk &#34;$infile&#34; cat $a-$b output &#34;${outputprefix}&#34;_$a-$b."/>


<link rel="stylesheet" href="https://aziz.tn/css/syntax.css" />

</head>
<body class="terminal">
    <div class="container">
        <div class="terminal-nav">
          <header class="terminal-logo">
            <div class="logo terminal-prompt">
              
              
              <a href="https://aziz.tn/" class="no-style ">Mohamed Aziz Knani (محمد عزيز الكناني) website</a>:~# 
              <a href='https://aziz.tn/posts'>posts</a>/<a href='https://aziz.tn/posts/how-i-print-books'>how-i-print-books</a>/</div></header>
          <nav class="terminal-menu">
            <ul vocab="https://schema.org/" typeof="BreadcrumbList">
                
                <li><a href="https://aziz.tn/about/" typeof="ListItem">about/</a></li>
                
                <li><a href="https://aziz.tn/posts/" typeof="ListItem">posts/</a></li>
                
            </ul>
          </nav>
        </div>
    </div>

    <div class="container animated fadeInDown fast" >
        
<h1>How I print books</h1>

Nov. 8, 2018


<br/><br/>
<p>I tend to print books and zines on paper rather than read it from the screen (I help to kill one small tree every week), I have some tools to do make this easier.</p>
<p>This is a shell script that splits a pdf into chapters using the builtin bookmarks:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span>
<span class="nv">infile</span><span class="o">=</span><span class="nv">$1</span> <span class="c1"># input pdf</span>
<span class="nv">outputprefix</span><span class="o">=</span><span class="nv">$2</span>

<span class="o">[</span> -e <span class="s2">&#34;</span><span class="nv">$infile</span><span class="s2">&#34;</span> -a -n <span class="s2">&#34;</span><span class="nv">$outputprefix</span><span class="s2">&#34;</span> <span class="o">]</span> <span class="o">||</span> <span class="nb">exit</span> <span class="m">1</span> <span class="c1"># Invalid args</span>

<span class="nv">pagenumbers</span><span class="o">=(</span> <span class="k">$(</span>pdftk <span class="s2">&#34;</span><span class="nv">$infile</span><span class="s2">&#34;</span> dump_data <span class="p">|</span> grep -A1 <span class="s1">&#39;^BookmarkLevel: 1&#39;</span><span class="p">|</span> <span class="se">\
</span><span class="se"></span>	      grep <span class="s1">&#39;^BookmarkPageNumber: &#39;</span> <span class="p">|</span> cut -f2 -d<span class="s1">&#39; &#39;</span> <span class="p">|</span> uniq<span class="k">)</span>
	    end <span class="o">)</span>

<span class="k">for</span> <span class="o">((</span><span class="nv">i</span><span class="o">=</span>0<span class="p">;</span> i &lt; <span class="si">${#</span><span class="nv">pagenumbers</span><span class="p">[@]</span><span class="si">}</span> - 1<span class="p">;</span> ++i<span class="o">))</span><span class="p">;</span> <span class="k">do</span>
  <span class="nv">a</span><span class="o">=</span><span class="si">${</span><span class="nv">pagenumbers</span><span class="p">[i]</span><span class="si">}</span> <span class="c1"># start page number</span>
  <span class="nv">b</span><span class="o">=</span><span class="si">${</span><span class="nv">pagenumbers</span><span class="p">[i+1]</span><span class="si">}</span> <span class="c1"># end page number</span>
  <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$b</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;end&#34;</span> <span class="o">]</span> <span class="o">||</span> <span class="nv">b</span><span class="o">=</span>$<span class="o">[</span>b-1<span class="o">]</span>
  pdftk <span class="s2">&#34;</span><span class="nv">$infile</span><span class="s2">&#34;</span> cat <span class="nv">$a</span>-<span class="nv">$b</span> output <span class="s2">&#34;</span><span class="si">${</span><span class="nv">outputprefix</span><span class="si">}</span><span class="s2">&#34;</span>_<span class="nv">$a</span>-<span class="nv">$b</span>.pdf
<span class="k">done</span>
</code></pre></div><p>I use duplex since I don&rsquo;t own a fancy printer that does in-hardware printing. duplex is a bunch of shell scripts that makes use of scripts provided by cups, it has a queue and can print non pdf documents (Postscript and textfiles).</p>
<p>I think definitively better than my old 5 line shell script that used pdftk:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">pdftk <span class="nv">A</span><span class="o">=</span><span class="nv">$1</span> cat Aeven output /tmp/even_pages.pdf
pdftk <span class="nv">A</span><span class="o">=</span><span class="nv">$1</span> cat Aodd  output /tmp/odd_pages.pdf
pdftk /tmp/even_pages.pdf cat end-1 output /tmp/even_pages1.pdf
lp /tmp/odd_pages.pdf
<span class="nb">read</span> -rsp <span class="s1">$&#39;Press any key when ready...\n&#39;</span> -n1 key
lp /tmp/even_pages1.pdf
</code></pre></div>


        <div class="footer">
    Powered by <a href="https://gohugo.io/">Hugo</a> with
    <a href="https://github.com/mrmierzejewski/hugo-theme-console/">Console Theme</a>. 
</div>

    </div>
  </body>
</html>
